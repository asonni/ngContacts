!function(){"use strict";var e=angular.module("codecraft");e.factory("Contact",["$resource",function(e){return e("https://codecraftpro.com/api/samples/v1/contact/:id/",{id:"@id"},{update:{method:"PUT"}})}]),e.service("ContactService",["Contact","$q","$rootScope","toastr",function(e,n,o,r){var t={addPerson:function(e){this.persons.push(e)},getPerson:function(e){for(var n=0;n<t.persons.length;n++){var o=t.persons[n];if(o.email==e)return o}},page:1,hasMore:!0,isLoading:!1,isSaving:!1,selectedPerson:null,persons:[],search:null,ordering:"name",doSearch:function(){t.hasMore=!0,t.page=1,t.persons=[],t.loadContacts()},doOrder:function(){t.hasMore=!0,t.page=1,t.persons=[],t.loadContacts()},loadContacts:function(){if(t.hasMore&&!t.isLoading){t.isLoading=!0;var n={page:t.page,search:t.search,ordering:t.ordering};e.get(n,function(n){angular.forEach(n.results,function(n){t.persons.push(new e(n))}),n.next||(t.hasMore=!1),t.isLoading=!1})}},loadMore:function(){t.hasMore&&!t.isLoading&&(t.page+=1,t.loadContacts())},updateContact:function(e){var o=n.defer();return t.isSaving=!0,e.$update().then(function(){t.isSaving=!1,r.info("Updated "+e.name),o.resolve()}),o.promise},removeContact:function(e){var o=n.defer();return t.isDeleting=!0,e.$remove().then(function(){t.isDeleting=!1;var n=t.persons.indexOf(e);t.persons.splice(n,1),t.selectedPerson=null,r.warning("Deleted "+e.name),o.resolve()}),o.promise},createContact:function(o){var a=n.defer();return t.isSaving=!0,e.save(o).$promise.then(function(){t.isSaving=!1,t.selectedPerson=null,t.hasMore=!0,t.page=1,t.persons=[],t.loadContacts(),r.success("Created "+o.name),a.resolve()}),a.promise},watchFilters:function(){o.$watch(function(){return t.search},function(e){angular.isDefined(e)&&t.doSearch()}),o.$watch(function(){return t.ordering},function(e){angular.isDefined(e)&&t.doOrder()})}};return t.loadContacts(),t.watchFilters(),t}])}();